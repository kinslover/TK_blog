<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Largest Rectangle in Histogram</title>
        <meta name="viewport" content="width=device-width">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css">

        <script type="text/javascript"
        src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
        </script> 

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-45812015-1', 'tkcrown.github.io');
      ga('send', 'pageview');

    </script>            


    </head>
    <body>

        <div class="site">
          <div class="header">
            <h1 class="title"><a href="/">TK_blog</a></h1>
            <a class="extra" href="/">Home</a>
            <a class="extra" href="/notes">Notes</a>
            <a class="extra" href="/cv/cv.pdf">CV</a>
            <a class="extra" href="/hobbies">Hobbies</a>
            <a class="extra" href="/algorithms">Algorithms</a>
            <a class="extra" href="/calendar">Calendar</a>
          </div>

          <h2>Largest Rectangle in Histogram</h2>
<p class="meta">19 Aug 2014</p>

<div class="post">
<h1 id="description">Description</h1>

<p>https://oj.leetcode.com/problems/largest-rectangle-in-histogram/</p>

<h1 id="analysis">Analysis</h1>

<p><strong>Key Observation</strong>: Given several consecutive bars, the bar with the mimimum height decides the area of the rectangle formed by those bars.</p>

<h2 id="solution-1">Solution 1</h2>

<p>The simplest method I can come up is that we enumerate each pair of start point and end point <script type="math/tex">[i, j]</script> and find the bar with minimum height in <script type="math/tex">[i, j]</script> and then compute the area. Next we update the <script type="math/tex">maxArea</script></p>

<div class="highlight"><pre><code class="ruby"><span class="n">maxArea</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">.</span><span class="n">.n</span><span class="o">-</span><span class="mi">1</span>
	<span class="k">for</span> <span class="n">j</span> <span class="o">=</span> <span class="n">i</span><span class="o">.</span><span class="n">.n</span><span class="o">-</span><span class="mi">1</span>
		<span class="n">curArea</span> <span class="o">=</span> <span class="n">min</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="n">i</span><span class="o">.</span><span class="n">.j</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span> <span class="n">j</span> <span class="o">-</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="sr">/* O(n) operation */</span>
		<span class="n">maxArea</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">curArea</span><span class="p">,</span> <span class="n">maxArea</span><span class="p">);</span>
</code></pre></div>

<p>Thus this is a naive <script type="math/tex">O(n^3)</script> solution.</p>

<h2 id="solution-2">Solution 2</h2>

<p>It is very easy to notice that there is lots of redundant computation involved in solution 1. When we compute the minimum height between bar <script type="math/tex">i</script> and <script type="math/tex">j</script>, we do not need to iterate from <script type="math/tex">i</script> to <script type="math/tex">j</script> every time, if we record, e.g. the min height between <script type="math/tex">i+1</script> and <script type="math/tex">j</script> in some variable <script type="math/tex">minHeight[i+1][j]</script>. Then</p>

<script type="math/tex; mode=display">minHeight[i][j] = min(height[i], minHeight[i+1][j])</script>

<p>This is a <script type="math/tex">O(n^2)</script> solution.</p>

<h2 id="solution-3">Solution 3</h2>

<p>Still following the thought the minimum bar is the key bar that decides the area of a rectangle, here I introduce another way of computing the <script type="math/tex">maxArea</script>. This solution is still <script type="math/tex">O(n^2)</script>, but a further improvement will be based on this one in solution 4.</p>

<div class="highlight"><pre><code class="ruby"><span class="n">maxArea</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">.</span><span class="n">.n</span><span class="o">-</span><span class="mi">1</span>
	<span class="n">curArea</span> <span class="o">=</span> <span class="n">height</span><span class="o">[</span><span class="n">i</span><span class="o">]</span>
	<span class="k">for</span> <span class="n">j</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="o">.</span><span class="n">.n</span><span class="o">-</span><span class="mi">1</span> <span class="o">//</span> <span class="n">find</span> <span class="n">right</span> <span class="n">boundary</span>
		<span class="k">if</span> <span class="n">height</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">&lt;=</span> <span class="n">height</span><span class="o">[</span><span class="n">j</span><span class="o">]</span>
			<span class="n">curArea</span> <span class="o">+=</span> <span class="n">height</span><span class="o">[</span><span class="n">j</span><span class="o">]</span><span class="p">;</span>
		<span class="k">else</span> <span class="k">break</span>
	<span class="k">for</span> <span class="n">j</span> <span class="o">=</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="o">.</span><span class="n">.</span><span class="mi">0</span>  <span class="o">//</span> <span class="n">find</span> <span class="n">left</span> <span class="n">boundary</span>
		<span class="k">if</span> <span class="n">height</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">&lt;=</span> <span class="n">height</span><span class="o">[</span><span class="n">j</span><span class="o">]</span>
			<span class="n">curArea</span> <span class="o">+=</span> <span class="n">height</span><span class="o">[</span><span class="n">j</span><span class="o">]</span><span class="p">;</span>
		<span class="k">else</span> <span class="k">break</span>
	<span class="n">maxArea</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">maxArea</span><span class="p">,</span> <span class="n">curArea</span><span class="p">);</span>
</code></pre></div>

<p>The key idea here is that in each outer loop, we take each bar as the minimum bar in the rectangle and find the left boundary and right boundary of the maximum rectangle that takes this bar as the mimimum bar. Then we compute the area and update <script type="math/tex">maxArea</script>. </p>

<p align="center">
<img src="/images/LargestRectangleinHistogram1.png" alt="Example of left boundary and right boundary" />
</p>

<h2 id="solution-4">Solution 4</h2>

<p>Here is an example</p>

<pre><code>bar height: 0, 1, 2, 3, 4, e.g. height[i] = i
</code></pre>

<p>In solution 3, when we compute the right boundary of <script type="math/tex">height[1]</script>, we have to iterate from 2 to 4. However an easy observation is that <script type="math/tex">right[1] >= right[2]</script>, as <script type="math/tex">height[2] >= height[1]</script>. In summary,</p>

<p><script type="math/tex">right[i] >= right[i+1]</script>, if and only if <script type="math/tex">% <![CDATA[
height[i] <= height[i+1] %]]></script>.</p>

<p>This observation will help us speed up the algorithm a lot.</p>

<p>Therefore once we find <script type="math/tex">% <![CDATA[
height[i] <= height[i+1] %]]></script>, we know that <script type="math/tex">right[i] >= right[i+1]</script>. Then we check if <script type="math/tex">% <![CDATA[
height[i] <= height[right[i+1]+1] %]]></script> or not. If so right[i] &gt;= right[right[i+1]+1]. So and so forth.</p>

<p>Here is an example</p>

<pre><code>bar height: 0, 1, 2, 3, 4, 2, 3
right:      6, 6, 5, 4, 4, 6, 6
</code></pre>

<p>Suppose that we are trying to compute <script type="math/tex">right[2]</script>, </p>

<ul>
  <li>Step1: we find that <script type="math/tex">height[3] >= height[2]</script>, then we go to <script type="math/tex">right[3]+1 = 5</script>. </li>
  <li>Step2: We find that <script type="math/tex">height[5] >= height[2]</script>, then we got to <script type="math/tex">right[5] + 1 = 6</script>. </li>
  <li>Step3: As <script type="math/tex">height[6] >= height[2]</script> and 6 is the last element, 6 is the right boundary for 2, e.g. <script type="math/tex">right[2] = 6</script>.</li>
</ul>

<p>It is the same procedure to find the left boundary.</p>

<h3 id="time-complextiy">Time complextiy</h3>

<p>I am not quite sure about the time complexity of this algorithm. The way I boost the speed is similar to the thought of path compression in Union-Find set. I tried to come up with some example to screw up this algorithm but failed. Anyway, the average time complexity will be way better than <script type="math/tex">O(n^2)</script> solution. The running time of it in leetcode is 64ms, which is not a bad result.</p>

<div class="highlight"><pre><code class="c++"><span class="lineno"> 1</span> <span class="k">class</span> <span class="nc">Solution</span> <span class="p">{</span>
<span class="lineno"> 2</span> <span class="nl">public:</span>
<span class="lineno"> 3</span>     <span class="kt">int</span> <span class="n">largestRectangleArea</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">height</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 4</span>         <span class="kt">int</span> <span class="n">maxArea</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="lineno"> 5</span>         <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="n">height</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
<span class="lineno"> 6</span>         
<span class="lineno"> 7</span>         <span class="kt">int</span> <span class="n">left</span><span class="p">[</span><span class="n">n</span><span class="p">];</span> <span class="c1">// array of left boundary for each bar</span>
<span class="lineno"> 8</span>         <span class="kt">int</span> <span class="n">right</span><span class="p">[</span><span class="n">n</span><span class="p">];</span> <span class="c1">// array of right boundary for each bar</span>
<span class="lineno"> 9</span>         
<span class="lineno">10</span>         <span class="c1">//looking for the left boundary</span>
<span class="lineno">11</span>         <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">height</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span> <span class="n">i</span><span class="p">){</span>
<span class="lineno">12</span>             <span class="n">left</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
<span class="lineno">13</span>             <span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>                       
<span class="lineno">14</span>             <span class="k">while</span><span class="p">(</span><span class="n">j</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="n">height</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">height</span><span class="p">[</span><span class="n">i</span><span class="p">]){</span>              
<span class="lineno">15</span>                 <span class="n">left</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">left</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
<span class="lineno">16</span>                 <span class="n">j</span> <span class="o">=</span> <span class="n">left</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span>
<span class="lineno">17</span>             <span class="p">}</span>
<span class="lineno">18</span>         <span class="p">}</span>
<span class="lineno">19</span>         <span class="c1">//looking for the right boundary</span>
<span class="lineno">20</span>         <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="p">;</span> <span class="o">--</span> <span class="n">i</span><span class="p">){</span>
<span class="lineno">21</span>             <span class="n">right</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="p">;</span>
<span class="lineno">22</span>             <span class="kt">int</span> <span class="n">j</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
<span class="lineno">23</span>             
<span class="lineno">24</span>             <span class="k">while</span><span class="p">(</span><span class="n">j</span> <span class="o">&lt;</span> <span class="n">n</span> <span class="o">&amp;&amp;</span> <span class="n">height</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">height</span><span class="p">[</span><span class="n">i</span><span class="p">]){</span>
<span class="lineno">25</span>                 <span class="n">right</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">right</span><span class="p">[</span><span class="n">j</span><span class="p">];</span>
<span class="lineno">26</span>                 <span class="n">j</span> <span class="o">=</span> <span class="n">right</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">;</span>
<span class="lineno">27</span>             <span class="p">}</span>
<span class="lineno">28</span>             <span class="n">maxArea</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">maxArea</span><span class="p">,</span> <span class="p">(</span><span class="n">right</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">left</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">height</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
<span class="lineno">29</span>         <span class="p">}</span>        
<span class="lineno">30</span> 
<span class="lineno">31</span>         <span class="k">return</span> <span class="n">maxArea</span><span class="p">;</span>
<span class="lineno">32</span>         
<span class="lineno">33</span>     <span class="p">}</span>
<span class="lineno">34</span> <span class="p">};</span>
</code></pre></div>


</div>

          <div class="footer">
            <div class="contact">
              <p>
                My Github<br />
                E-mail<br />
                LinkedIn
              </p>
            </div>
            <div class="contact">
              <p>
                <a href="https://github.com/tkcrown">github.com/tkcrown</a><br />
                pjin1[[at]]ualberta[dot]ca<br />
                http://www.linkedin.com/pub/ping-jin/3a/a3b/97a
              </p>
            </div>
          </div>



    <!--disqus-->
    
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'tkcrown'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    
    



    </body>
</html>
