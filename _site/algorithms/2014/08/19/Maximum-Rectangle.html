<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <title>Maximal Rectangle</title>
        <meta name="viewport" content="width=device-width">

        <!-- syntax highlighting CSS -->
        <link rel="stylesheet" href="/css/syntax.css">

        <!-- Custom CSS -->
        <link rel="stylesheet" href="/css/main.css">

        <script type="text/javascript"
        src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
        </script> 

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-45812015-1', 'tkcrown.github.io');
      ga('send', 'pageview');

    </script>            


    </head>
    <body>

        <div class="site">
          <div class="header">
            <h1 class="title"><a href="/">TK_blog</a></h1>
            <a class="extra" href="/">Home</a>
            <a class="extra" href="/notes">Notes</a>
            <a class="extra" href="/cv/cv.pdf">CV</a>
            <a class="extra" href="/hobbies">Hobbies</a>
            <a class="extra" href="/algorithms">Algorithms</a>
            <a class="extra" href="/calendar">Calendar</a>
          </div>

          <h2>Maximal Rectangle</h2>
<p class="meta">19 Aug 2014</p>

<div class="post">
<h1 id="description">Description</h1>

<p>Given a 2D binary matrix filled with 0’s and 1’s, find the largest rectangle containing all ones and return its area.</p>

<h1 id="analysis">Analysis</h1>

<p>This is an interesting problem. It is hard to come up with the best solution if you have not solved Largest Rectangle in Histogram.</p>

<p>The brute-force solution to this problem is very time consuming. The worst one could be <script type="math/tex">O(n^3m^3)</script>, by enumerate the pair of top-left corner and bottom-right corner, where <script type="math/tex">n</script> is the number of rows and <script type="math/tex">m</script> is the number of columns.</p>

<p>The interesting part is that we actually can use the solution of Largest Rectangle in Histogram as a sub-procedure to solve this problem in <script type="math/tex">O(nm)</script> time, which is a great improvement compared with the bruteforce solution.</p>

<p>The way to do it is that we enumerate each row to find the largest rectangle that lies on this row (i.e. the bottom of the rectangle is on this row) and then identify the maximum one across rows. For each row, what we need to do is exactly what we do in Largest Rectangle in Histogram.</p>

<p>As we run the sub-procedure <script type="math/tex">n</script> times, the time complexity of which is <script type="math/tex">O(m)</script>, the total time complexity of the algorithm is <script type="math/tex">O(nm)</script>.</p>

<p>The code below is pretty self-explained.</p>

<h1 id="solution">Solution</h1>

<div class="highlight"><pre><code class="c++"><span class="lineno"> 1</span> <span class="k">class</span> <span class="nc">Solution</span> <span class="p">{</span>
<span class="lineno"> 2</span> <span class="nl">public:</span>
<span class="lineno"> 3</span>     <span class="kt">int</span> <span class="n">maximalRectangle</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">&gt;</span> <span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">matrix</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno"> 4</span>         <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">matrix</span><span class="p">.</span><span class="n">size</span><span class="p">())</span> <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="lineno"> 5</span>         
<span class="lineno"> 6</span>         <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span><span class="n">cur</span><span class="p">;</span>
<span class="lineno"> 7</span>         <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span> <span class="n">i</span><span class="p">)</span>
<span class="lineno"> 8</span>             <span class="n">cur</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="sc">&#39;0&#39;</span><span class="p">);</span>
<span class="lineno"> 9</span>         
<span class="lineno">10</span>         <span class="kt">int</span> <span class="n">maxArea</span> <span class="o">=</span> <span class="n">largestRectangleArea</span><span class="p">(</span><span class="n">cur</span><span class="p">);</span>
<span class="lineno">11</span>         
<span class="lineno">12</span>         <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">matrix</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span> <span class="n">i</span><span class="p">){</span>
<span class="lineno">13</span>             <span class="n">accumulate</span><span class="p">(</span><span class="n">matrix</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">cur</span><span class="p">);</span>
<span class="lineno">14</span>             <span class="n">maxArea</span> <span class="o">=</span> <span class="n">max</span><span class="p">(</span><span class="n">maxArea</span><span class="p">,</span> <span class="n">largestRectangleArea</span><span class="p">(</span><span class="n">cur</span><span class="p">));</span>
<span class="lineno">15</span>         <span class="p">}</span>
<span class="lineno">16</span>         <span class="k">return</span> <span class="n">maxArea</span><span class="p">;</span>
<span class="lineno">17</span>     <span class="p">}</span>
<span class="lineno">18</span> 
<span class="lineno">19</span>     <span class="kt">int</span> <span class="n">largestRectangleArea</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">height</span><span class="p">)</span> <span class="p">{</span>
<span class="lineno">20</span>         <span class="c1">// Solution to the Largest Rectangle in Histogram can be found at </span>
<span class="lineno">21</span>         <span class="c1">// http://tkcrown.github.io/TK_blog/algorithms/2014/08/19/Largest-Rectangle-in-Histogram.html</span>
<span class="lineno">22</span>     <span class="p">}</span>
<span class="lineno">23</span> 
<span class="lineno">24</span>     <span class="kt">void</span> <span class="n">accumulate</span><span class="p">(</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">char</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">source</span><span class="p">,</span> <span class="n">vector</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="o">&amp;</span><span class="n">target</span><span class="p">){</span>
<span class="lineno">25</span>         <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="n">target</span><span class="p">.</span><span class="n">size</span><span class="p">();</span>
<span class="lineno">26</span>         <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="o">++</span> <span class="n">i</span><span class="p">)</span>
<span class="lineno">27</span>             <span class="n">target</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">source</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39;1&#39;</span><span class="p">)</span> <span class="o">?</span> <span class="n">target</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span> <span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
<span class="lineno">28</span>     <span class="p">}</span>
<span class="lineno">29</span> <span class="p">};</span>
</code></pre></div>

</div>

          <div class="footer">
            <div class="contact">
              <p>
                My Github<br />
                E-mail<br />
                LinkedIn
              </p>
            </div>
            <div class="contact">
              <p>
                <a href="https://github.com/tkcrown">github.com/tkcrown</a><br />
                pjin1[[at]]ualberta[dot]ca<br />
                http://www.linkedin.com/pub/ping-jin/3a/a3b/97a
              </p>
            </div>
          </div>



    <!--disqus-->
    
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'tkcrown'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    
    



    </body>
</html>
